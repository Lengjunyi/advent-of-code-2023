s = """#.###########################################################################################################################################
#...........#...#...#.....#.......#...#.........#...#####.......#...#...#.......#.......#.....#...#.....#.......#.....#.....#...###...#.....#
###########.#.#.#.#.#.###.#.#####.#.#.#.#######.#.#.#####.#####.#.#.#.#.#.#####.#.#####.#.###.#.#.#.###.#.#####.#.###.#.###.#.#.###.#.#.###.#
#...........#.#.#.#.#.#...#.#.....#.#.#.......#.#.#.....#...#...#.#.#.#.#...#...#.#.....#...#...#.#.#...#.#.....#...#.#...#.#.#.#...#.#.#...#
#.###########.#.#.#.#.#.###.#.#####.#.#######.#.#.#####.###.#.###.#.#.#.###.#.###.#.#######.#####.#.#.###.#.#######.#.###.#.#.#.#.###.#.#.###
#.....#...###.#.#.#...#...#.#.#...#.#.#...#...#.#.#...#.###.#...#.#.#.#.#...#.#...#...>.>.#.#.....#.#.###.#.#...#...#...#.#.#.#.#...#.#.#.###
#####.#.#.###.#.#.#######.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###.###.#.#.#.#.#.###.#.#######v#.#.#.#####.#.###.#.#.#.#.#####.#.#.#.#.###.#.#.#.###
#.....#.#...#.#.#.#.......#.#.#.#...#.#.#.#...#.#.#.#...#...#...#.#.#.#.#...#.#.#.......#...#.....#.#.#...#.#.#.#.....#.#.#.#.#.###.#.#.#...#
#.#####.###.#.#v#.#.#######.#.#.#####.#.#.###.#.#.#.#####.###.###.#.#.#.###.#.#.#.###############.#.#.#.###.#.#.#####.#.#.#.#.#.###.#.#.###.#
#.#...#.#...#.#.>.#...#...#.#.#.....#...#...#.#...#...>.>.###...#.#.#.#.#...#.#.#.#.........#.....#.#.#.#...#.#.###...#.#.#.#.#.....#...#...#
#.#.#.#.#.###.#v#####.#.#.#.#.#####.#######.#.#########v#######.#.#.#.#.#.###.#.#.#.#######.#.#####.#.#.#.###.#.###.###.#.#.#.###########.###
#.#.#...#.#...#.###...#.#...#.#.....#.....#.#...#.......###...#...#.#.#...###...#...#.......#.....#.#.#.#.#...#.>.>.###.#.#.#.#.........#...#
#.#.#####.#.###.###.###.#####.#.#####.###.#.###.#.#########.#.#####.#.###############.###########.#.#.#.#.#.#####v#####.#.#.#.#.#######.###.#
#.#.#...#.#.###...#.....#.....#.#.....#...#.#...#.....#.....#.....#...#...........#...#...#...#...#.#...#...#...#...#...#.#...#.......#.#...#
#.#.#.#.#.#.#####.#######.#####.#.#####.###.#.#######.#.#########.#####.#########.#.###.#.#.#.#.###.#########.#.###.#.###.###########.#.#.###
#.#.#.#...#.#.....###.....#...#...#...#...#.#.#.....#...#.........#...#.#.......#.#.....#.#.#.#.....###...#...#.#...#...#.#...........#.#.###
#.#.#.#####.#.#######.#####.#.#####.#.###.#.#.#.###.#####.#########.#.#.#.#####.#.#######.#.#.#########.#.#.###.#.#####.#.#.###########.#.###
#...#.......#.......#.....#.#.#.>.>.#.#...#.#.#...#.......#...#...#.#...#.#.....#.........#.#...#.......#.#...#.#.#...#...#...........#.#...#
###################.#####.#.#.#.#v###.#.###.#.###.#########.#.#.#.#.#####.#.###############.###.#.#######.###.#.#.#.#.###############.#.###.#
#...................###...#.#...#...#.#.###...#...#.........#...#.#...#...#...#...#.........#...#.......#...#.#.#...#...#.............#.....#
#.#####################.###.#######.#.#.#######.###.#############.###.#.#####.#.#.#.#########.#########.###.#.#.#######.#.###################
#...#...#.............#.....#.......#...#...###.#...#.............###...#####...#...#.....#...###.....#...#.#.#.........#...................#
###.#.#.#.###########.#######.###########.#.###.#.###.###############################.###.#.#####.###.###.#.#.#############################.#
###...#...###.........#...###.............#...#.#.#...#...#.....#.....#...#...###.....###...#...#...#.....#.#...#.........................#.#
#############.#########.#.###################.#.#.#.###.#.#.###.#.###.#.#.#.#.###.###########.#.###.#######.###.#.#######################.#.#
#.............#...###...#...#...........#.....#...#.....#...#...#...#.#.#.#.#...#.....#.....#.#...#.....###.....#...#...#.....#.........#...#
#.#############.#.###.#####.#.#########.#.###################.#####.#.#.#.#.###.#####.#.###.#.###.#####.###########.#.#.#.###.#.#######.#####
#...............#.....#.....#.........#.#.###...###...#.......###...#.#.#.#.#...#...#.#.#...#...#.....#...........#.#.#...###...###...#...###
#######################.#############.#.#.###.#.###.#.#.#########.###.#.#.#.#.###.#.#.#.#.#####.#####.###########.#.#.#############.#.###.###
###...................#.......#.......#...#...#.#...#.#...###...#...#.#.#.#.#.###.#.#.#.#.#...#.#.....#...........#...#.............#...#...#
###.#################.#######.#.###########.###.#.###.###v###.#.###.#.#.#.#.#.###.#.#v#.#.#.#.#.#.#####v###############.###############.###.#
#...#...#.....#...###.........#...........#...#.#...#.#.>.>.#.#...#.#.#.#.#.#.#...#.>.>.#...#.#.#...#.>.>...#.....#...#.#.............#...#.#
#.###.#.#.###.#.#.#######################.###.#.###.#.#.#v#.#.###.#.#.#.#.#.#.#.#####v#######.#.###.#.#v###.#.###.#.#.#.#.###########.###.#.#
#...#.#...#...#.#.#...###...#.............#...#.#...#.#.#.#...#...#.#.#.#.#.#.#.....#.#.....#.#...#.#.#.#...#.#...#.#.#...#...........###...#
###.#.#####.###.#v#.#.###.#.#.#############.###.#.###.#.#.#####.###.#.#.#.#.#.#####.#.#.###.#.###.#.#.#.#.###.#.###.#.#####.#################
###...#...#.....#.>.#...#.#.#.....#...#...#...#.#...#...#.....#.#...#.#.#.#.#.....#.#...#...#.....#...#.#.....#...#.#...#...#...............#
#######.#.#######v#####.#.#.#####.#.#.#.#.###.#.###.#########.#.#.###.#.#.#.#####.#.#####.#############.#########.#.###.#.###.#############.#
###...#.#.#...#...#.....#.#.#...#.#.#.#.#.#...#.#...###.......#...###...#...#...#.#.#...#.....#.........#...#.....#.#...#.....#.............#
###.#.#.#.#.#.#.###.#####.#.#.#.#v#.#.#.#.#.###.#.#####.#####################.#.#.#.#.#.#####.#.#########.#.#.#####.#.#########.#############
#...#...#.#.#.#.###.....#.#.#.#.>.>.#...#.#.#...#...#...#.......#.....#.....#.#.#...#.#.......#.........#.#...#...#.#.....#...#...........###
#.#######.#.#.#.#######.#.#.#.###v#######.#.#.#####.#.###.#####.#.###.#.###.#.#.#####.#################.#.#####.#.#.#####.#.#.###########.###
#.#.....#...#.#...#...#...#...###.....###...#.......#.#...#.....#.#...#...#...#.......#...###...#.......#...###.#.#.#.....#.#.#...#.....#...#
#.#.###.#####.###.#.#.###############.###############.#.###.#####.#.#####.#############.#.###.#.#.#########.###.#.#.#.#####.#.#.#.#v###.###.#
#.#.###.....#.....#.#.#...............#...#.....#.....#.###.......#.....#.....#...#.....#.....#.#...#.....#...#.#.#.#.#...#.#...#.>.###.....#
#.#.#######.#######.#.#.###############.#.#.###.#.#####.###############.#####.#.#.#.###########.###.#.###.###.#.#.#.#.#.#.#.#######v#########
#...#.......#.......#.#.#.....#...#...#.#...#...#.#...#.#...............#...#.#.#.#.#...........###...#...#...#.#.#.#...#.#...#.....#...#####
#####.#######.#######.#.#.###.#.#.#.#.#.#####.###.#.#.#.#.###############.#.#.#.#.#.#.#################.###.###.#.#.#####.###.#.#####.#.#####
###...#...#...#.......#...#...#.#.#.#.#.#.....###...#...#.............#...#.#.#.#...#.............###...###.....#.#.#.....#...#.......#.....#
###.###.#.#.###.###########.###.#.#.#.#.#.###########################.#.###.#.#.#################.###.###########.#.#.#####.###############.#
#...#...#...###.........#...#...#.#.#.#.#.......#...................#...#...#...###...............#...#...#...###...#.....#.#...#...........#
#.###.#################.#.###.###.#.#.#.#######.#.#################.#####.#########.###############.###.#.#.#.###########.#.#.#.#.###########
#...#.#.................#...#.#...#.#...#.......#...#...........###.......#...#...#...............#.....#...#...###...###...#.#.#...........#
###.#.#.###################.#.#.###.#####.#########.#.#########.###########.#.#.#.###############.#############.###.#.#######.#.###########.#
###...#...................#...#.....#.....#...#...#...#.........#...###...#.#.#.#.#...###...#.....#...#.......#...#.#.........#...#...#...#.#
#########################.###########.#####.#.#.#.#####.#########.#.###.#.#.#.#.#.#.#.###.#.#.#####.#.#.#####.###.#.#############.#.#.#.#.#.#
#.........................#...#...###.......#...#.#...#.......#...#...#.#.#.#.#.#.#.#.#...#.#.#.....#.#.#.....#...#.............#.#.#...#.#.#
#.#########################.#.#.#.###############.#.#.#######.#.#####.#.#.#.#.#.#.#.#.#.###.#.#.#####.#.#.#####v###############.#.#.#####.#.#
#.#.............###...#...#.#...#.#...#.........#.#.#.#.......#.....#.#.#.#.#.#.#.#.#.#...#...#.....#...#...#.>.>.#.......#.....#...#...#...#
#.#.###########v###.#.#.#.#.#####.#.#.#.#######.#.#.#.#.###########.#.#.#.#.#.#.#.#.#.###v#########.#######.#.#v#.#.#####.#.#########.#.#####
#...#...#...###.>...#...#.#...#...#.#.#.......#...#.#.#...........#.#.#.#.#.#.#.#.#.#.#.>.>.#.....#.......#...#.#.#.#.....#...........#.....#
#####.#.#.#.###v#########.###.#.###.#.#######.#####.#.###########.#.#.#.#.#.#.#.#.#.#.#.#v#.#.###.#######.#####.#.#.#.#####################.#
#.....#...#.....#...#.....#...#...#.#.........###...#.#.....#.....#.#.#.#.#.#...#...#...#.#.#.#...#...#...#.....#.#.#.#...###...#...........#
#.###############.#.#.#####.#####.#.#############.###.#.###.#.#####.#.#.#.#.#############.#.#.#.###.#.#.###.#####.#.#.#.#.###.#.#.###########
#.#.............#.#...#...#.....#.#.......###...#.#...#...#.#.#...#.#...#.#.###...........#...#.#...#...###.....#...#...#.#...#...#...#...###
#.#.###########.#.#####.#.#####.#.#######v###.#.#.#.#####.#.#v#.#.#.#####.#.###.###############.#.#############.#########.#.#######.#.#.#.###
#...###...#.....#.....#.#...#...#...#...>.>...#...#.#...#.#.>.>.#...#.....#...#.........#...#...#.###...#...###...#.......#...#.....#...#...#
#######.#.#.#########.#.###.#.#####.#.###v#########.#.#.#.###v#######.#######.#########.#.#.#.###.###.#.#.#.#####.#.#########v#.###########.#
#.......#.#.........#.#.###.#.#####...###.........#.#.#.#...#...#...#.......#.#.........#.#.#.....#...#...#.......#.....#...>.#.#...........#
#.#######.#########.#.#.###.#.###################.#.#.#.###.###.#.#.#######.#.#.#########.#.#######.###################.#.###v#.#.###########
#.......#...........#...###...###...###.....#.....#.#.#.#...###...#...#.....#.#.....#.....#...#...#.....#...#.........#.#.###...#...........#
#######.#########################.#.###.###.#.#####.#.#.#.###########.#.#####.#####.#.#######.#.#.#####.#.#.#.#######.#.#.#################.#
#.......#...#.........#.......#...#...#...#.#.....#.#.#...#...#.......#...#...#...#...#.......#.#.....#...#...#.......#.#.#...............#.#
#.#######.#.#.#######.#.#####.#.#####.###.#.#####.#.#.#####.#.#.#########.#.###.#.#####.#######.#####.#########.#######.#.#.#############.#.#
#.....#...#...#.......#.#.....#...#...#...#.#.....#...#...#.#.#.....#...#...###.#.###...#...###.#...#.....#...#.......#...#.............#.#.#
#####.#.#######.#######.#.#######.#.###.###.#.#########.#.#.#.#####.#.#.#######.#.###.###.#.###.#.#.#####.#.#.#######.#################v#.#.#
#.....#.#.......#...#...#...#...#.#.....###...#.....#...#...#.......#.#.#.......#...#.....#...#...#.....#.#.#.......#.#.....#...#...#.>.#...#
#.#####.#.#######.#.#.#####.#.#.#.#############.###.#.###############.#.#.#########.#########.#########.#.#.#######.#.#.###.#.#.#.#.#.#v#####
#...#...#...#.....#.#...#...#.#.#.....#...#.....#...#.................#.#.......#...#.....#...#.....###.#.#.#.....#...#.#...#.#.#.#.#.#...###
###.#.#####.#.#####.###.#.###.#.#####.#.#.#.#####.#####################.#######.#.###.###.#.###.###.###.#.#.#.###.#####.#.###.#.#.#.#.###.###
###...#...#...#.....###.#.###.#.#.....#.#...#...#.#...#...#.....#...#...###.....#.###...#...###...#.#...#...#.#...#...#.#.#...#...#.#.###...#
#######.#.#####v#######.#.###.#.#v#####.#####.#.#.#.#.#.#.#.###.#.#.#.#####.#####.#####v#########.#.#.#######.#.###.#.#.#.#.#######.#.#####.#
#.....#.#.#...#.>.#...#.#.#...#.>.>...#.#.....#...#.#.#.#.#...#...#.#.....#.....#.....>.>.#...###.#.#.......#.#.#...#.#.#.#.....#...#.#.....#
#.###.#.#.#.#.#v#.#.#.#.#.#.#####v###.#.#.#########.#.#.#.###.#####.#####.#####.#######v#.#.#.###.#.#######.#.#.#.###.#.#.#####.#.###.#.#####
#...#.#.#.#.#.#.#.#.#.#.#...#####...#...#.....#...#.#.#.#...#.....#.#.....#...#.###...#.#...#...#.#.#.....#.#.#.#...#.#.#.#...#.#.....#...###
###.#.#.#.#.#.#.#.#.#.#.###########.#########.#.#.#.#.#.###.#####.#.#.#####.#.#.###.#.#.#######.#.#.#.###.#.#.#.###.#.#.#.#.#.#.#########.###
#...#...#...#...#...#.#.......#.....#.........#.#.#.#.#.#...#...#.#...#...#.#.#.#...#...#.......#.#.#...#...#.#.#...#.#.#.#.#...###...###...#
#.###################.#######.#.#####.#########.#.#.#.#.#.###.#.#.#####.#.#.#.#.#.#######.#######.#.###v#####.#.#.###.#.#.#.#######.#.#####.#
#.......#...........#...#.....#.....#...#...###.#.#.#.#.#.###.#.#.###...#.#.#.#.#.......#.#.......#.#.>.>.....#.#...#.#.#...#.......#.......#
#######.#.#########.###.#.#########.###.#.#.###.#.#.#.#.#.###.#.#v###.###.#.#.#.#######.#.#.#######.#.#v#######.###.#.#.#####.###############
###...#...#.......#.#...#...#.......#...#.#.#...#.#.#.#.#.#...#.>.>.#...#.#.#.#.#.....#.#.#...#.....#.#.#...###.#...#.#.....#...............#
###.#.#####.#####.#.#.#####.#.#######.###.#.#.###.#.#.#.#.#.#####v#.###.#.#.#.#.#.###.#.#.###.#.#####.#.#.#.###.#.###.#####.###############.#
#...#.#...#.....#.#.#.....#.#.......#.....#.#.#...#.#...#...#...#.#.....#...#...#...#...#.#...#.#...#.#.#.#...#...###.......#...#...#####...#
#.###.#.#.#####.#.#.#####.#.#######.#######.#.#.###.#########.#.#.#################.#####.#.###.#.#.#.#.#.###.###############.#.#.#.#####.###
#...#...#.......#...#####...#####...#...###...#...#.#.....#...#.#.......#.........#.....#...###...#...#...###...#.......#...#.#...#.......###
###.#############################.###.#.#########.#.#.###.#.###.#######.#.#######.#####.#######################.#.#####.#.#.#.###############
###.....................#.........#...#...###...#...#...#.#...#.#...#...#.....#...#.....#...#...#.......#.......#.#.....#.#.#.............###
#######################.#.#########.#####.###.#.#######.#.###.#.#.#.#.#######.#.###.#####.#.#.#.#.#####.#.#######.#.#####.#.#############.###
#.............#.........#.#.....#...#####...#.#.....#...#.###.#...#...#.......#.....#...#.#.#.#.#...#...#.........#...###.#.###...#...###...#
#.###########.#.#########.#.###.#.#########.#.#####.#.###.###.#########.#############.#.#.#.#.#.###.#.###############.###.#.###.#.#.#.#####.#
#...........#.#.........#...###...#...#.....#.#.....#...#...#.#.....###...#.....#...#.#.#.#.#.#.###.#.#...#...#.....#.#...#...#.#...#.......#
###########.#.#########.###########.#.#.#####.#.#######.###.#.#.###.#####.#.###.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#v###.#.#.#####.#.#############
#.......#...#.#...#...#.###.......#.#.#.......#.###...#.#...#.#.#...#...#...###...#.#.#.#.#.#.#.#...#.#.#...#.>.>.#...#...#...#.......#.....#
#.#####.#.###.#.#.#.#.#.###.#####.#.#.#########.###.#.#.#.###v#.#.###.#.###########v#.#.#.#.#.#.#.###.#.#######v#.#######.#.#########.#.###.#
#.#...#...###...#...#...#...#.....#.#.#...#.....#...#.#.#...>.>.#.#...#.#.....#...>.>.#...#.#.#...###...###...#.#...#...#.#...#.....#.#.#...#
#.#.#.###################.###.#####.#.#.#.#.#####.###.#.#####v###.#.###.#.###.#.###v#######.#.#############.#.#.###.#.#.#.###.#.###.#.#.#.###
#...#.....#...###...#...#...#.#...#.#...#.#.#...#...#.#.....#...#.#.###...###...#...###.....#...#...........#.#.###...#.#...#...#...#...#...#
#########.#.#.###.#.#.#.###.#.#.#.#.#####.#.#.#.###.#.#####.###.#.#.#############.#####.#######.#.###########.#.#######.###.#####.#########.#
#.........#.#.#...#.#.#...#.#.#.#.#.....#.#.#.#.#...#.#.....#...#...###...........#...#.........#...........#.#.....#...###.#.....#...###...#
#.#########.#.#.###.#.###.#.#.#.#.#####.#.#.#.#.#.###.#.#####.#########.###########.#.#####################.#.#####.#.#####.#.#####.#.###v###
#.#.....#...#.#.#...#...#.#.#.#.#.#...#.#.#.#.#.#...#.#.....#.#...#...#...#...#...#.#.###.........###.....#.#.......#...#...#.#...#.#.#.>.###
#.#.###.#.###.#.#.#####.#.#.#.#.#.#.#.#.#.#v#.#.###.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.###.#######.###.###.#.###########.#.###.#.#.#.#.#.#v###
#...###.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.>.>.#...#.#.#.....#...#...#...#...#...#...#...#...#...#.....#...#.........#...#...#.#.#...#...#...#
#######v###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###v#####.#.#.#.###############.###############.###.#.#.#######.###########.#.#####.#.#.###########.#
###...#.>.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...###...#.#.#.#.............#...#.............###...#.......#...#.....#...#.#...#.#.#.###...#.....#
###.#.#v#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#####.###.#.#.#.###########.###.#.#########################.###.#.###.#.###.#.#.#.#.#.###.#.#.#####
#...#...#...#...#.#.#...#...#...#.#.###...###...#...#...#...#...#...#.#...#.............#...#...#.....###.#...#...###...#...#.#.#...#...#...#
#.###############.#.#############.#.###.#####.###.#########.#.#.#.#.#.#.###############.#.#.#.#.#.#######.###.###############.#.#.#######.#.#
#.........#.....#.#.#.....###...#...#...#...#...#...#.....#...#...#.#...#.............#...#.#.#.#.......#.....###...#...#...#...#.#.......#.#
#########.#.###.#.#.#.###.###.#.#####.###.#.###.###.#.###.#########.#####.###########.#####.#.#.#######.#########.#.#.#.#.#.#####.#.#######.#
###.......#.#...#...#...#...#.#.###...#...#.###.#...#.#...#...#...#.....#...........#.#...#.#.#.....#...#...###...#...#.#.#.#...#...#.......#
###.#######.#.#########.###.#.#.###.###.###.###.#.###.#.###.#.#.#.#####.###########.#.#.#.#.#.#####.#.###.#.###.#######.#.#.#.#.#####.#######
#...#.....#.#.#...#...#.#...#.#.#...###.#...#...#...#.#.#...#...#.....#...#.........#...#...#.....#...#...#...#.......#.#.#.#.#...###.......#
#.###.###.#.#.#.#.#.#.#.#.###.#.#v#####.#.###.#####.#.#.#.###########.###.#.#####################.#####.#####.#######.#.#.#.#.###.#########.#
#.....###...#.#.#...#...#...#.#.>.>.#...#...#.......#.#.#.....#.....#.....#.........#.....#...#...#...#...#...###...#.#.#.#.#...#.###.......#
#############.#.###########.#.#####.#.#####.#########.#.#####.#.###.###############.#.###.#.#.#.###.#.###.#.#####.#.#.#.#.#.###.#.###v#######
#.....#...###.#.........#...#.....#...###...#...#...#.#.#...#...#...#.....###.......#.#...#.#.#...#.#.#...#...#...#.#.#.#.#.#...#...>.#.....#
#.###.#.#.###.#########.#.#######.#######.###.#.#.#.#.#.#.#.#####.###.###.###.#######.#.###.#.###.#.#.#.#####.#.###.#.#.#.#.#.#######v#.###.#
#...#...#.....#.....#...#.#.......###...#.###.#.#.#.#.#.#.#...###...#...#...#.#.......#.#...#.###...#.#.#####.#.#...#.#...#...#.......#.#...#
###.###########.###.#.###.#.#########.#.#.###.#.#.#.#.#.#.###.#####.###.###.#.#.#######.#.###.#######.#.#####.#.#.###.#########.#######.#.###
###...........#...#.#...#...#.........#...#...#.#.#.#.#.#.#...#...#.###.#...#...#.......#...#.#...#...#.....#.#.#...#.......###.........#...#
#############.###.#.###.#####.#############.###.#.#.#.#.#.#.###.#.#.###.#.#######v#########.#.#.#.#.#######.#.#.###.#######.###############.#
#.............#...#...#.....#.........#...#.#...#.#.#.#.#.#.###.#.#.#...#.#...#.>.>.....#...#.#.#.#...#.....#.#...#...#.....#...#...#.......#
#.#############.#####.#####.#########.#.#.#.#.###.#.#.#.#.#.###.#.#v#.###.#.#.#.#######.#.###.#.#.###.#.#####.###.###.#.#####.#.#.#.#.#######
#.#...#.......#.#####.......#.........#.#.#.#.#...#.#.#...#.#...#.>.>.#...#.#...#.......#.#...#.#.###.#.....#.#...#...#.#.....#...#...#...###
#.#.#.#.#####.#.#############.#########.#.#.#.#.###.#.#####.#.#########.###.#####.#######.#.###.#.###v#####.#.#.###.###.#.#############.#.###
#...#...#.....#.........#####...#...#...#...#.#.###.#.....#.#.......#...#...#.....#.....#.#.#...#.#.>.>...#.#.#...#.#...#.#...#...#...#.#.###
#########.#############.#######.#.#.#.#######.#.###.#####.#.#######.#.###.###.#####.###.#.#.#.###.#.#####.#.#.###.#.#.###.#.#.#.#.#.#.#.#.###
#.........#...#...#...#.......#.#.#.#.#.......#...#.#...#.#.#...#...#...#...#.....#.#...#.#.#...#.#.....#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.###
#.#########.#.#.#.#.#.#######.#.#.#.#.#.#########.#.#.#.#.#.#.#.#.#####.###.#####.#.#.###.#.###.#.#####.#.#.#.#.###.#.#.###.#.#.#.#.#.#.#.###
#...........#...#...#.........#...#...#...........#...#...#...#...#####.....#####...#.....#.....#.......#...#...###...#.....#...#...#...#...#
###########################################################################################################################################.#"""

s1 = """#.#####################
#.......#########...###
#######.#########.#.###
###.....#.>.>.###.#.###
###v#####.#v#.###.#.###
###.>...#.#.#.....#...#
###v###.#.#.#########.#
###...#.#.#.......#...#
#####.#.#.#######.#.###
#.....#.#.#.......#...#
#.#####.#.#.#########v#
#.#...#...#...###...>.#
#.#.#v#######v###.###v#
#...#.>.#...>.>.#.###.#
#####v#.#.###v#.#.###.#
#.....#...#...#.#.#...#
#.#########.###.#.#.###
#...###...#...#...#.###
###.###.#.###v#####v###
#...#...#.#.>.>.#.>.###
#.###.###.#.###.#.#v###
#.....###...###...#...#
#####################.#"""

# 5986 6100 ??6222 6300?? 6500 ---> 6426

import sys
sys.setrecursionlimit(5000)

g = s.split("\n")

M = len(g)
N = len(g[0])
start = None
for i in range(N):
    if g[0][i] == ".":
        start = i

end = None
for i in range(N):
    if g[M-1][i] == ".":
        end = i
ans = 0

ans_cnt = 0

visited = set()
visited.add((0,start))

stack = [(0,start,0, True)]
while stack:
    x,y,total, f = stack.pop()
    if not f:
        visited.remove((x,y))
        # visited.difference_update(total)
        continue

    visited.add((x,y))
    s = set()
    s.add((x,y))
    # print(x,y)

    stack.append((x,y,s, False))

   
    # if (x,y) in visited:
    #     print("ERROR")
    #     exit()
    xs = [0,1,0,-1]
    ys = [1,0,-1,0]

    if (x,y) == (M-1,end):
        # print(total)
        ans_cnt += 1
        if ans_cnt % 1000 ==0:
            print(ans_cnt, ans)
        if total > ans:
            ans = total
        # for i in range(M):
        #     for j in range(N):
        #         if (i,j) in visited:
        #             print("O",end="")
        #         else:
        #             print(g[i][j], end = "")
        #     print()

    poss = []

    if g[x][y] in "v^><" and False:
        i = ">v<^".index(g[x][y])
        poss = [(x+xs[i], y+ys[i])]
        if (x+xs[i], y+ys[i]) in visited:
            poss = []
        # print(poss, x,y, i)
        
    else:
        while True:
            if (x,y) == (M-1,end): ###
                # print(total)
                ans_cnt += 1
                if ans_cnt % 1000 ==0:
                    print(ans_cnt, ans)
                if total > ans:
                    ans = total ###
            for j in range(4):
                nx = x+xs[j]
                ny = y+ys[j]
                if (nx,ny) in visited or (nx, ny) in s:
                    continue
                if nx>=M or ny>=N or nx<0 or ny<0:
                    continue
                if g[nx][ny] == "#":
                    continue
                poss.append((nx,ny))
            if len(poss) == 1:
                x,y = poss[0]
                total += 1
                s.add((x,y))
                # visited.add((x,y))
                poss = []
                continue
            else:
                visited.add((x,y))
                stack.append((x,y,s, False))
                break
            break
    # if (x,y) not in [(5,3)]:
    #     print(x,y,poss)
    #     exit()
    # print(x,y,total,poss)
    
    for pos in poss:
        # if pos in visited:
        #     print("ERROR")
        #     exit()
        # visited.add(pos)
        stack.append((pos[0],pos[1],total+1,True))
        # find(pos[0], pos[1], total+1)
        # visited.remove(pos)
    # visited.

print("FINAL",ans)

# ended up having 3 parallel runs in the background. none of which significantly faster
# took a lot of time to run; up to when I got the gold star it hadn't stopped running.
